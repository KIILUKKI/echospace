<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<title>Pieni Chat</title>
<style>
body { font-family: sans-serif; background:#111; color:#eee }
#chat { height:300px; overflow-y:auto; border:1px solid #444; padding:5px }
input, button { width:100%; margin-top:5px }
</style>
</head>
<body>

<h2>ðŸ”¥ Mini Chat</h2>
<div id="chat"></div>

<input id="name" placeholder="Nimi">
<input id="msg" placeholder="Viesti">
<button onclick="send()">LÃ¤hetÃ¤</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, collection, addDoc,
  query, orderBy, onSnapshot, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// ðŸ”¥ LIITÃ„ TÃ„HÃ„N OMA FIREBASE CONFIG
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
apiKey: "AIzaSyDbYLUXJjHQ-V5uFvtyzwq-IwIKM7xTcyc",
authDomain: "chat-fc8ef.firebaseapp.com",
projectId: "chat-fc8ef",
storageBucket: "chat-fc8ef.firebasestorage.app",
messagingSenderId: "446356718094",
appId: "1:446356718094:web:f56514352845d6bbb7b25f"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const chat = document.getElementById("chat");

const q = query(collection(db, "messages"), orderBy("time"));
onSnapshot(q, snap => {
  chat.innerHTML = "";
  snap.forEach(d => {
    const m = d.data();
    chat.innerHTML += `<div><b>${m.name}:</b> ${m.text}</div>`;
  });
  chat.scrollTop = chat.scrollHeight;
});

window.send = async () => {
  const name = document.getElementById("name").value || "Anon";
  const text = document.getElementById("msg").value;
  if (!text) return;

  await addDoc(collection(db, "messages"), {
    name, text, time: serverTimestamp()
  });

  document.getElementById("msg").value = "";
};
</script>

</body>
</html>
